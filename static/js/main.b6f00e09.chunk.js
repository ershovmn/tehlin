(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{132:function(e,t,n){e.exports=n(170)},170:function(e,t,n){"use strict";n.r(t);n(133),n(158);var a=n(0),s=n.n(a),r=n(25),o=n.n(r),i=n(17),l=n.n(i),c=n(20),u=n(21),m=n(23),h=n(22),d=n(24),p=n(6),g=(n(169),function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(m.a)(this,Object(h.a)(t).call(this))).sendForm=function(){e.state.firstName.length>0&&e.state.lastName.length>0&&e.state.groupID.length>0&&(console.log("hello"),fetch(sessionStorage.getItem("address")+"/api/v0/firstlogin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userid:e.state.userID,firstname:e.state.firstName,lastname:e.state.lastName,middlename:e.state.middleName,groupid:e.state.groupID,gender:e.state.gender})}).then(function(e){return e.json()}).then(function(t){sessionStorage.setItem("token",t.token),e.props.go("home")}))},e.state={firstName:"",lastName:"",middleName:"",userID:null,groupID:"",gender:!0,fetchedUser:null},e}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;l.a.sendPromise("VKWebAppGetUserInfo",{}).then(function(t){console.log(t),"\u041c\u0435\u0449\u0435\u0440\u0441\u043a\u0430\u044f"===t.last_name&&(t.last_name="\u0415\u0440\u0449\u0435\u0440\u0441\u043a\u0430\u044f"),"\u0415\u0440\u0448\u043e\u0432"===t.last_name&&(t.last_name="\u0415\u0440\u0449\u0435\u0440\u0441\u043a\u0438\u0439"),e.setState({firstName:t.first_name,lastName:t.last_name,middleName:"",userID:t.id,groupID:"",gender:2===t.sex})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this,t=this.state.firstName.length>0&&this.state.lastName.length>0&&this.state.groupID.length>0;return s.a.createElement(p.h,{id:this.props.id},s.a.createElement(p.i,null,"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"),s.a.createElement("p",null,"\u0412\u043d\u0438\u043c\u0430\u043d\u0438\u0435!!!"),s.a.createElement("p",null,"\u0424\u0418\u041e \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u043e\u0441\u043b\u0435 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u043c\u043e\u0436\u043d\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043c\u043e\u0434\u0435\u0440\u0430\u0442\u043e\u0440\u0430!"),s.a.createElement("p",null,'\u0414\u0430\u043d\u043d\u043e\u0435 \u0424\u0418\u041e \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u043e \u0432 \u043f\u043e\u043b\u0435 \u043e\u0442\u0447\u0435\u0442\u0430 "\u0432\u044b\u043f\u043e\u043b\u043d\u0438\u043b"'),s.a.createElement(p.d,null,s.a.createElement(p.f,{top:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f",value:this.state.lastName,onChange:function(t){return e.setState({lastName:t.target.value})},status:this.state.lastName.length>0?"valid":"error"}),s.a.createElement(p.f,{top:"\u0418\u043c\u044f",value:this.state.firstName,onChange:function(t){return e.setState({firstName:t.target.value})},status:this.state.firstName.length>0?"valid":"error"}),s.a.createElement(p.f,{top:"\u041e\u0442\u0447\u0435\u0441\u0442\u0432\u043e",value:this.state.middleName,onChange:function(t){return e.setState({middleName:t.target.value})},status:"valid"}),s.a.createElement(p.l,{value:this.state.gender?"m":"f",top:"\u041f\u043e\u043b",onChange:function(t){return e.setState({gender:"m"===t.target.value})},status:"valid"},s.a.createElement("option",{value:"m"},"\u041c\u0443\u0436\u0441\u043a\u043e\u0439"),s.a.createElement("option",{value:"f"},"\u0416\u0435\u043d\u0441\u043a\u0438\u0439")),s.a.createElement(p.f,{top:"\u041d\u043e\u043c\u0435\u0440 \u0433\u0440\u0443\u043f\u043f\u044b",value:this.state.groupID,onChange:function(t){return e.setState({groupID:t.target.value})},status:this.state.groupID.length>0?"valid":"error"}),s.a.createElement(p.a,{size:"xl",disabled:!t,onClick:function(){return e.sendForm()}},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f")))}}]),t}(s.a.Component)),f=n(80),v=n.n(f),E=n(81),b=n.n(E),k=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(m.a)(this,Object(h.a)(t).call(this))).onRefresh=function(){e.setState({fetching:!0}),fetch(sessionStorage.getItem("address")+"/api/v0/allreports",{method:"GET",headers:{"tehnarenok-token":sessionStorage.getItem("token")}}).then(function(e){return e.json()}).then(function(t){e.setState({reports:t.reports,isFetching:!1})})},e.state={activePanel:"reports",reports:[],popout:s.a.createElement(p.k,null),isFetching:!1},e}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch(sessionStorage.getItem("address")+"/api/v0/allreports",{method:"GET",headers:{"tehnarenok-token":sessionStorage.getItem("token")}}).then(function(e){return e.json()}).then(function(t){e.setState({reports:t.reports,popout:null})})}},{key:"render",value:function(){return console.log(this.state),s.a.createElement(p.o,{id:this.props.id,activePanel:this.state.activePanel,popout:this.state.popout},s.a.createElement(p.h,{id:"reports"},s.a.createElement(p.i,null,"\u041e\u0442\u0447\u0435\u0442\u044b"),s.a.createElement(p.j,{onRefresh:this.onRefresh,isFetching:this.state.fetching},s.a.createElement(p.e,null,s.a.createElement(p.g,null,this.state.reports&&this.state.reports.length>0&&this.state.reports.map(function(e){return s.a.createElement(p.b,{key:e._id,description:e.discription},e.name)}))))))}}]),t}(s.a.Component),S=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(m.a)(this,Object(h.a)(t).call(this))).state={activeStory:"reports"},e}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement(p.c,{id:this.props.id,activeStory:this.state.activeStory,tabbar:s.a.createElement(p.m,null,s.a.createElement(p.n,{onClick:function(){return e.setState({activeStory:"reports"})},selected:"reports"===this.state.activeStory,text:"\u041e\u0442\u0447\u0435\u0442\u044b"},s.a.createElement(v.a,null)),s.a.createElement(p.n,{onClick:function(){return e.setState({activeStory:"settings"})},selected:"settings"===this.state.activeStory,text:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"},s.a.createElement(b.a,null)))},s.a.createElement(k,{id:"reports"}),s.a.createElement(p.o,{id:"settings",activePanel:"settings"},s.a.createElement(p.h,{id:"settings"},s.a.createElement(p.i,null,"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"))))}}]),t}(s.a.Component),j=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(h.a)(t).call(this,e))).go=function(e){n.setState({popout:null,activePanel:e})},n.state={activePanel:"black",fetchedUser:null,popout:s.a.createElement(p.k,null),token:null},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;l.a.sendPromise("VKWebAppGetUserInfo",{}).then(function(t){e.setState({fetchedUser:t}),fetch(sessionStorage.getItem("address")+"/api/v0/gettoken?userid=".concat(e.state.fetchedUser.id),{method:"GET"}).then(function(e){return e.json()}).then(function(t){t.token?(sessionStorage.setItem("token",t.token),e.setState({activePanel:"home",popout:null,token:t.token})):e.setState({activePanel:"firstlogin",popout:null})})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){return console.log(this.state),s.a.createElement(p.o,{activePanel:this.state.activePanel,popout:this.state.popout},s.a.createElement(p.h,{id:"black"}," "),s.a.createElement(g,{id:"firstlogin",go:this.go}),s.a.createElement(S,{id:"home"}))}}]),t}(s.a.Component);l.a.send("VKWebAppInit",{}),sessionStorage.setItem("address","https://4239c859.ngrok.io"),l.a.subscribe(function(e){switch(e.detail.type){case"VKWebAppUpdateConfig":var t=document.createAttribute("scheme");t.value=e.detail.data.scheme?e.detail.data.scheme:"client_light",document.body.attributes.setNamedItem(t)}}),o.a.render(s.a.createElement(j,null),document.getElementById("root"))}},[[132,1,2]]]);
//# sourceMappingURL=main.b6f00e09.chunk.js.map