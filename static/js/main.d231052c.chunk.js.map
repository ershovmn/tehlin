{"version":3,"sources":["panels/FirstLogin.js","panels/Home.js","App.js","index.js"],"names":["FirstLogin","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","sendForm","state","firstName","length","lastName","groupID","console","log","fetch","method","headers","Content-Type","body","JSON","stringify","userid","userID","firstname","lastname","middlename","middleName","groupid","gender","then","data","json","sessionStorage","setItem","token","props","go","fetchedUser","_this2","connect","sendPromise","last_name","setState","first_name","id","sex","catch","error","_this3","flag","react_default","a","createElement","es6","top","value","onChange","e","target","status","placeholder","size","disabled","onClick","React","Component","Home","activeStory","tabbar","selected","text","note_default","settings_default","activePanel","App","panel","popout","concat","panels_FirstLogin","panels_Home","send","ReactDOM","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.d231052c.chunk.js","sourcesContent":["import React from 'react'\r\n\r\nimport {View, Panel, FormLayout, Input, Select, Button, PanelHeader} from '@vkontakte/vkui'\r\nimport connect from '@vkontakte/vk-connect'\r\n\r\nclass FirstLogin extends React.Component {\r\n    constructor() {\r\n        super()\r\n        this.state = {\r\n            firstName: '',\r\n            lastName: '',\r\n            middleName: '',\r\n            userID: null,\r\n            groupID: '',\r\n            gender: true,\r\n            fetchedUser: null\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        \r\n        \r\n        connect.sendPromise('VKWebAppGetUserInfo', {})\r\n\t\t\t.then(data => {\r\n                console.log(data)\r\n                //this.setState({ fetchedUser: data})\r\n                if(data.last_name === 'Мещерская') {\r\n                    data.last_name = 'Ерщерская'\r\n                }\r\n                if(data.last_name === 'Ершов') {\r\n                    data.last_name = 'Ерщерский'\r\n                }\r\n\r\n                this.setState({\r\n                    firstName: data.first_name,\r\n                    lastName: data.last_name,\r\n                    middleName: '',\r\n                    userID: data.id,\r\n                    groupID: '',\r\n                    gender: data.sex === 2,\r\n                })\r\n\t\t\t})\r\n\t\t\t.catch(error => {\r\n\t\t\t\tconsole.log(error)\r\n\t\t\t})\r\n    }\r\n\r\n    sendForm = () => {\r\n        if(!(this.state.firstName.length > 0 &&\r\n            this.state.lastName.length > 0 &&\r\n            this.state.groupID.length > 0)) {\r\n            return\r\n        } else {\r\n            console.log('hello')\r\n            fetch('https://4239c859.ngrok.io/api/v0/firstlogin', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json'\r\n                },\r\n                body: JSON.stringify({\r\n                    userid: this.state.userID,\r\n                    firstname: this.state.firstName,\r\n                    lastname: this.state.lastName,\r\n                    middlename: this.state.middleName,\r\n                    groupid: this.state.groupID,\r\n                    gender: this.state.gender\r\n                })\r\n            }).then(data => {\r\n                return data.json()\r\n            }).then(data => {\r\n                sessionStorage.setItem('token', data.token)\r\n                this.props.go('home')\r\n            })\r\n        }\r\n    }\r\n\r\n    render() {\r\n        var flag = (this.state.firstName.length > 0) &&\r\n            (this.state.lastName.length > 0) &&\r\n            (this.state.groupID.length > 0)\r\n        \r\n        return (\r\n            <Panel id={this.props.id}>\r\n                <PanelHeader>\r\n                    Регистрация\r\n                </PanelHeader>\r\n                <p>\r\n                    Внимание!!!\r\n                </p>\r\n                <p>\r\n                    ФИО изменить после регистрации можно только с помощью модератора!\r\n                </p>\r\n                <p>\r\n                    Данное ФИО будет использовано в поле отчета \"выполнил\"\r\n                </p>\r\n                <FormLayout>\r\n                    <Input \r\n                        top=\"Фамилия\"\r\n                        value={this.state.lastName}\r\n                        onChange={(e) => this.setState({lastName: e.target.value})}\r\n                        status={this.state.lastName.length > 0 ? 'valid' : 'error'}\r\n                    />\r\n                    <Input \r\n                        top=\"Имя\"\r\n                        value={this.state.firstName}\r\n                        onChange={(e) => this.setState({firstName: e.target.value})}\r\n                        status={this.state.firstName.length > 0 ? 'valid' : 'error'}\r\n                    />\r\n                    <Input \r\n                        top=\"Отчество\"\r\n                        value={this.state.middleName}\r\n                        onChange={(e) => this.setState({middleName: e.target.value})}\r\n                    />\r\n                    <Select value={this.state.gender ? \"m\" : \"f\"} top=\"Пол\" placeholder=\"\" onChange={(e) => this.setState({gender: e.target.value === \"m\"})}>\r\n                        <option value=\"m\">Мужской</option>\r\n                        <option value=\"f\">Женский</option>\r\n                    </Select>\r\n                    <Input \r\n                        top=\"Номер группы\"\r\n                        value={this.state.groupID}\r\n                        onChange={(e) => this.setState({groupID: e.target.value})}\r\n                        status={this.state.groupID.length > 0 ? 'valid' : 'error'}\r\n                    />\r\n                    <Button size=\"xl\" disabled={!flag} onClick={() => this.sendForm()}>Зарегистрироваться</Button>\r\n                </FormLayout>\r\n            </Panel>\r\n        )\r\n    }\r\n}\r\n\r\nexport default FirstLogin","import React from 'react'\r\n\r\nimport {View, Panel, Epic, Tabbar, TabbarItem, PanelHeader} from '@vkontakte/vkui'\r\n\r\nimport Icon24Note from '@vkontakte/icons/dist/24/note';\r\nimport Icon24Settings from '@vkontakte/icons/dist/24/settings';\r\n\r\nclass Home extends React.Component {\r\n    constructor() {\r\n        super()\r\n        this.state = {\r\n            activeStory: 'home'\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <Epic id={this.props.id} activeStory={this.state.activeStory} tabbar ={\r\n                <Tabbar>\r\n                    <TabbarItem\r\n                        onClick={() => this.setState({activeStory: 'home'})}\r\n                        selected={this.state.activeStory === 'home'}\r\n                        text='Home'\r\n                    >\r\n                        <Icon24Note />\r\n                    </TabbarItem>\r\n                    \r\n                    <TabbarItem \r\n                        onClick={() => this.setState({activeStory: 'settings'})}\r\n                        selected={this.state.activeStory === 'settings'}\r\n                        text='Settings'\r\n                    >\r\n                        <Icon24Settings />\r\n                    </TabbarItem>\r\n                </Tabbar>\r\n            }>\r\n                <View id='home' activePanel='home'>\r\n                    <Panel id='home'>\r\n                        <PanelHeader>\r\n                            Home\r\n                        </PanelHeader>\r\n                    </Panel>\r\n                </View>\r\n                <View id='settings' activePanel='settings'>\r\n                    <Panel id='settings'>\r\n                        <PanelHeader>\r\n                            Settings\r\n                        </PanelHeader>\r\n                    </Panel>\r\n                </View>\r\n\r\n            </Epic>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Home","import React from 'react';\nimport connect from '@vkontakte/vk-connect';\nimport { View, Panel, ScreenSpinner, PanelHeader } from '@vkontakte/vkui';\nimport '@vkontakte/vkui/dist/vkui.css';\n\nimport FirstLogin from './panels/FirstLogin'\nimport Home from './panels/Home'\n\nclass App extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\tactivePanel: 'black',\n\t\t\tfetchedUser: null,\n\t\t\tpopout: <ScreenSpinner />,\n\t\t\ttoken: null\n\t\t};\n\t}\n\n\tcomponentDidMount() {\n\t\tconnect.sendPromise('VKWebAppGetUserInfo', {})\n\t\t\t.then(data => {\n\t\t\t\tthis.setState({ fetchedUser: data})\n\t\t\t\tfetch(`https://4239c859.ngrok.io/api/v0/gettoken?userid=${this.state.fetchedUser.id}`, {\n\t\t\t\t\tmethod: 'GET',\n\t\t\t\t}).then(data => {\n\t\t\t\t\treturn data.json()\n\t\t\t\t}).then(data => {\n\t\t\t\t\tif(data.token) {\n\t\t\t\t\t\tsessionStorage.setItem('token', data.token)\n\t\t\t\t\t\t//console.log(sessionStorage.getItem('token'))\n\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\tactivePanel: 'home',\n\t\t\t\t\t\t\tpopout: null,\n\t\t\t\t\t\t\ttoken: data.token\n\t\t\t\t\t\t})\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\tactivePanel: 'firstlogin',\n\t\t\t\t\t\t\tpopout: null\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t})\n\t\t\t.catch(error => {\n\t\t\t\tconsole.log(error)\n\t\t\t})\n\t\t\n\t}\n\n\tgo = (panel) => {\n\t\tthis.setState({\n\t\t\tpopout: null,\n\t\t\tactivePanel: panel\n\t\t})\n\t}\n\n\trender() {\n\t\tconsole.log(this.state)\n\t\treturn (\n\t\t\t<View activePanel={this.state.activePanel} popout={this.state.popout}>\n\t\t\t\t<Panel id='black'> </Panel>\n\t\t\t\t<FirstLogin id='firstlogin' go={this.go} />\n\t\t\t\t<Home id='home' />\n\t\t\t</View>\n\t\t);\n\t}\n}\n\nexport default App;\n","import 'core-js/es6/map';\nimport 'core-js/es6/set';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport connect from '@vkontakte/vk-connect';\nimport App from './App';\n// import registerServiceWorker from './sw';\n\n// Init VK App\nconnect.send('VKWebAppInit', {});\n\n// Если вы хотите, чтобы ваше веб-приложение работало в оффлайне и загружалось быстрее,\n// расскомментируйте строку с registerServiceWorker();\n// Но не забывайте, что на данный момент у технологии есть достаточно подводных камней\n// Подробнее про сервис воркеры можно почитать тут — https://vk.cc/8MHpmT \n// registerServiceWorker();\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}